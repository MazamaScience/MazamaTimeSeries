<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Get time related information — timeInfo • MazamaTimeSeries</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Get time related information — timeInfo" />
<meta property="og:description" content="Calculate the local time at the target location, as well as
sunrise, sunset and solar noon times, and create several temporal masks.
The returned dataframe will have as many rows as the length of the incoming
UTC time vector and will contain the following columns:

localStdTime_UTC -- UTC representation of local standard time
daylightSavings -- logical mask = TRUE if daylight savings is in effect
localTime -- local clock time
sunrise -- time of sunrise on each localTime day
sunset -- time of sunset on each localTime day
solarnoon -- time of solar noon on each localTime day
day -- logical mask = TRUE between sunrise and sunset
morning -- logical mask = TRUE between sunrise and solarnoon
afternoon -- logical mask = TRUE between solarnoon and sunset
night -- logical mask = opposite of day

" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MazamaTimeSeries</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/MazamaTimeSeries.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Developer_Style_Guide.html">Developer Style Guide</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/MazamaScience/MazamaTimeSeries/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Get time related information</h1>
    <small class="dont-index">Source: <a href='https://github.com/MazamaScience/MazamaTimeSeries/blob/master/R/timeInfo.R'><code>R/timeInfo.R</code></a></small>
    <div class="hidden name"><code>timeInfo.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculate the local time at the target location, as well as
sunrise, sunset and solar noon times, and create several temporal masks.</p>
<p>The returned dataframe will have as many rows as the length of the incoming
UTC <code>time</code> vector and will contain the following columns:</p>
<ul>
<li><p><code>localStdTime_UTC</code> -- UTC representation of local <strong>standard</strong> time</p></li>
<li><p><code>daylightSavings</code> -- logical mask = TRUE if daylight savings is in effect</p></li>
<li><p><code>localTime</code> -- local clock time</p></li>
<li><p><code>sunrise</code> -- time of sunrise on each localTime day</p></li>
<li><p><code>sunset</code> -- time of sunset on each localTime day</p></li>
<li><p><code>solarnoon</code> -- time of solar noon on each localTime day</p></li>
<li><p><code>day</code> -- logical mask = TRUE between sunrise and sunset</p></li>
<li><p><code>morning</code> -- logical mask = TRUE between sunrise and solarnoon</p></li>
<li><p><code>afternoon</code> -- logical mask = TRUE between solarnoon and sunset</p></li>
<li><p><code>night</code> -- logical mask = opposite of day</p></li>
</ul>

    </div>

    <pre class="usage"><span class='fu'>timeInfo</span><span class='op'>(</span>time <span class='op'>=</span> <span class='cn'>NULL</span>, longitude <span class='op'>=</span> <span class='cn'>NULL</span>, latitude <span class='op'>=</span> <span class='cn'>NULL</span>, timezone <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>time</th>
      <td><p>POSIXct vector with specified timezone,</p></td>
    </tr>
    <tr>
      <th>longitude</th>
      <td><p>Longitude of the location of interest.</p></td>
    </tr>
    <tr>
      <th>latitude</th>
      <td><p>Latitude of the location of interest.</p></td>
    </tr>
    <tr>
      <th>timezone</th>
      <td><p>Olson timezone at the location of interest.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A dataframe with times and masks.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>NOAA used the reference below to develop their Sunrise/Sunset</p>
<p><a href='https://gml.noaa.gov/grad/solcalc/sunrise.html'>https://gml.noaa.gov/grad/solcalc/sunrise.html</a> and Solar
Position</p>
<p><a href='https://gml.noaa.gov/grad/solcalc/azel.html'>https://gml.noaa.gov/grad/solcalc/azel.html</a>
Calculators.  The algorithms include corrections for atmospheric
refraction effects.</p>
<p>Input can consist of one location and at least one POSIXct times, or one
POSIXct time and at least one location.  <var>solarDep</var> is recycled as
needed.</p>
<p>Do not use the daylight savings time zone string for supplying
<var>dateTime</var>, as many OS will not be able to properly set it to
standard time when needed.</p>
<p>The <code>localStdTime_UTC</code> column in the returned dataframe is primarily for
internal use and provides an important tool for creating LST daily averages
and LST axis labeling.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>NOAA notes that “for latitudes greater than 72 degrees N and S,
calculations are accurate to within 10 minutes. For latitudes less than +/-
72 degrees accuracy is approximately one minute.”</p>
    <h2 class="hasAnchor" id="attribution"><a class="anchor" href="#attribution"></a>Attribution</h2>

    

<p>Internal functions used for ephemerides calculations were copied verbatim
from the <a href='https://cran.r-project.org/package=maptools'>https://cran.r-project.org/package=maptools</a> package source
code in an effort to reduce the number of package dependencies.</p>
    <h2 class="hasAnchor" id="warning"><a class="anchor" href="#warning"></a>Warning</h2>

    

<p>Compared to NOAA's original Javascript code, the sunrise and sunset estimates
from this translation may differ by +/- 1 minute, based on tests using
selected locations spanning the globe. This translation does not include
calculation of prior or next sunrises/sunsets for locations above the Arctic
Circle or below the Antarctic Circle.</p>
    <h2 class="hasAnchor" id="local-standard-time"><a class="anchor" href="#local-standard-time"></a>Local Standard Time</h2>

    

<p>US EPA regulations mandate that daily averages be calculated
based on "Local Standard Time" (LST) (<em>i.e. never shifting to daylight
savings</em>). To ease work in a regulatory context, LST times are included in the
returned dataframe.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    

<p>Meeus, J. (1991) Astronomical Algorithms. Willmann-Bell, Inc.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Sebastian P. Luque <a href='mailto:spluque@gmail.com'>spluque@gmail.com</a>, translated from
Greg Pelletier's <a href='mailto:gpel461@ecy.wa.gov'>gpel461@ecy.wa.gov</a> VBA code (available from
<a href='https://ecology.wa.gov/Research-Data/Data-resources/Models-spreadsheets/Modeling-the-environment/Models-tools-for-TMDLs'>https://ecology.wa.gov/Research-Data/Data-resources/Models-spreadsheets/Modeling-the-environment/Models-tools-for-TMDLs</a>), who in turn
translated it from original Javascript code by NOAA (see Details).
Roger Bivand <a href='mailto:roger.bivand@nhh.no'>roger.bivand@nhh.no</a> adapted the code to work with
<span class="pkg">sp</span> classes. Jonathan Callahan <a href='mailto:jonathan.callahan@gmail.com'>jonathan.callahan@gmail.com</a>
adapted the source code from the <span class="pkg">maptools</span> package to work with
<span class="pkg">MazamaTimeSeries</span> classes.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/MazamaScience/MazamaTimeSeries'>MazamaTimeSeries</a></span><span class='op'>)</span>

<span class='va'>Carmel</span> <span class='op'>&lt;-</span>
  <span class='va'>Carmel_Valley</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='mts_filterDate.html'>mts_filterDate</a></span><span class='op'>(</span><span class='fl'>20160801</span>, <span class='fl'>20160810</span><span class='op'>)</span>

<span class='co'># Create timeInfo object for this monitor</span>
<span class='va'>ti</span> <span class='op'>&lt;-</span> <span class='fu'>timeInfo</span><span class='op'>(</span>
  <span class='va'>Carmel</span><span class='op'>$</span><span class='va'>data</span><span class='op'>$</span><span class='va'>datetime</span>,
  <span class='va'>Carmel</span><span class='op'>$</span><span class='va'>meta</span><span class='op'>$</span><span class='va'>longitude</span>,
  <span class='va'>Carmel</span><span class='op'>$</span><span class='va'>meta</span><span class='op'>$</span><span class='va'>latitude</span>,
  <span class='va'>Carmel</span><span class='op'>$</span><span class='va'>meta</span><span class='op'>$</span><span class='va'>timezone</span>
<span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>ti</span><span class='op'>[</span><span class='fl'>6</span><span class='op'>:</span><span class='fl'>9</span>,<span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                       6                     7                    
#&gt; localStandardTime_UTC "2016-08-01 04:00:00" "2016-08-01 05:00:00"
#&gt; daylightSavings       "TRUE"                "TRUE"               
#&gt; localTime             "2016-08-01 05:00:00" "2016-08-01 06:00:00"
#&gt; sunrise               "2016-08-01 06:13:45" "2016-08-01 06:13:45"
#&gt; sunset                "2016-08-01 20:12:10" "2016-08-01 20:12:10"
#&gt; solarnoon             "2016-08-01 13:13:13" "2016-08-01 13:13:13"
#&gt; day                   "FALSE"               "FALSE"              
#&gt; morning               "FALSE"               "FALSE"              
#&gt; afternoon             "FALSE"               "FALSE"              
#&gt; night                 "TRUE"                "TRUE"               
#&gt;                       8                     9                    
#&gt; localStandardTime_UTC "2016-08-01 06:00:00" "2016-08-01 07:00:00"
#&gt; daylightSavings       "TRUE"                "TRUE"               
#&gt; localTime             "2016-08-01 07:00:00" "2016-08-01 08:00:00"
#&gt; sunrise               "2016-08-01 06:13:45" "2016-08-01 06:13:45"
#&gt; sunset                "2016-08-01 20:12:10" "2016-08-01 20:12:10"
#&gt; solarnoon             "2016-08-01 13:13:13" "2016-08-01 13:13:13"
#&gt; day                   "TRUE"                "TRUE"               
#&gt; morning               "TRUE"                "TRUE"               
#&gt; afternoon             "FALSE"               "FALSE"              
#&gt; night                 "FALSE"               "FALSE"              </div><div class='input'>
<span class='co'># Subset the data based on day/night masks</span>
<span class='va'>data_day</span> <span class='op'>&lt;-</span> <span class='va'>Carmel</span><span class='op'>$</span><span class='va'>data</span><span class='op'>[</span><span class='va'>ti</span><span class='op'>$</span><span class='va'>day</span>,<span class='op'>]</span>
<span class='va'>data_night</span> <span class='op'>&lt;-</span> <span class='va'>Carmel</span><span class='op'>$</span><span class='va'>data</span><span class='op'>[</span><span class='va'>ti</span><span class='op'>$</span><span class='va'>night</span>,<span class='op'>]</span>

<span class='co'># Build two monitor objects</span>
<span class='va'>Carmel_day</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>meta <span class='op'>=</span> <span class='va'>Carmel</span><span class='op'>$</span><span class='va'>meta</span>, data <span class='op'>=</span> <span class='va'>data_day</span><span class='op'>)</span>
<span class='va'>Carmel_night</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>meta <span class='op'>=</span> <span class='va'>Carmel</span><span class='op'>$</span><span class='va'>meta</span>, data <span class='op'>=</span> <span class='va'>data_night</span><span class='op'>)</span>

<span class='co'># Plot them</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>Carmel_day</span><span class='op'>$</span><span class='va'>data</span>, pch <span class='op'>=</span> <span class='fl'>8</span>, col <span class='op'>=</span> <span class='st'>'goldenrod'</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>Carmel_night</span><span class='op'>$</span><span class='va'>data</span>, pch <span class='op'>=</span> <span class='fl'>16</span>, col <span class='op'>=</span> <span class='st'>'darkblue'</span><span class='op'>)</span>
</div><div class='img'><img src='timeInfo-1.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jonathan Callahan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


